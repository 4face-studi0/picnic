apply plugin: 'java-library'
sourceCompatibility = JavaVersion.VERSION_1_6
targetCompatibility = JavaVersion.VERSION_1_6

apply plugin: 'org.jetbrains.kotlin.jvm'
compileKotlin {
  kotlinOptions {
    jvmTarget = '1.8'
    freeCompilerArgs = [
        '-progressive',
    ]
  }
}

dependencies {
  api deps.kotlinStdLib

  testImplementation deps.junit
  testImplementation deps.truth
}

apply plugin: 'org.jetbrains.dokka'
def dokkaDir = "$buildDir/dokka"
dokka {
  outputFormat = 'html'
  outputDirectory = dokkaDir
}
def javadocJarTaskProvider = tasks.register('javadocJar', Jar) { task ->
  task.archiveClassifier.set('javadoc')
  task.from(dokkaDir)
  task.dependsOn('dokka')
}

def sourcesJarTaskProvider = tasks.register('sourcesJar', Jar) { task ->
  task.archiveClassifier.set('sources')
  task.from(sourceSets.main.allSource)
}

artifacts {
  archives javadocJarTaskProvider
  archives sourcesJarTaskProvider
}
